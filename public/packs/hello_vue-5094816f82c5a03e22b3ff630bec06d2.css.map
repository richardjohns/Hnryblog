{"version":3,"file":"hello_vue-5094816f82c5a03e22b3ff630bec06d2.css","sources":["webpack:///./app/javascript/app/javascript/app.vue"],"sourcesContent":["<template>\n  <draggable v-model=\"lists\" id=\"app\" :options=\"{group: 'lists'}\" class=\"row dragArea\" @end=\"listMoved\">\n    <div v-for=\"(list, index) in lists\" class=\"col-3\">\n    <h6>{{ list.name }}</h6>\n    <hr />\n\n      <draggable v-model=\"list.cards\" :options=\"{group: 'cards'}\" class=\"dragArea\" @change=\"cardMoved\">\n        <div v-for=\"(card, index) in list.cards\" class=\"card card-body mb-3\">\n          {{ card.name }}\n        </div>\n      </draggable>\n\n        <div class=\"card card-body\">\n          <textarea v-model=\"messages[list.id]\" class=\"form-control\"></textarea>\n          <button v-on:click=\"submitMessages(list.id)\" class=\"btn btn-secondary\">Add</button>\n        </div>\n    </div>\n  </draggable>\n</template>\n\n<script>\nimport draggable from \"vuedraggable\"\n\nexport default {\n  components: { draggable }, // gives access to draggable tag above when we render our template.\n  props: [\"original_lists\"],\n  data: function () {\n    return {\n      messages: {},\n      lists: this.original_lists\n      // puts copy of lists from parent into component for manipulating\n    }\n  },\n  methods: {\n    cardMoved: function(event) {\n      console.log('This is cardMoved event: ',event)\n      const evt = event.added || event.moved\n\n      if (evt == undefined) { return }\n\n      const element = evt.element\n      console.log('This is element: ', element)\n      const list_index = this.lists.findIndex((list) => {\n        return list.cards.find((card) => {\n          return card.id === element.id\n        })\n      })\n\n      var data = new FormData\n      // console.log('This is data before: ',data)\n      // console.log('This is this.lists: ', this.lists)\n      data.append(\"card[list_id]\", this.lists[list_index].id)\n      data.append(\"card[position]\", evt.newIndex + 1)\n      // console.log('This is data after: ',data)\n      Rails.ajax({\n        url: `/cards/${element.id}/move`,\n        type: \"PATCH\",\n        data: data,\n        dataType: \"json\",\n      })\n    },\n    listMoved: function(event) {\n      var data = new FormData\n      // console.log('This is data before: ',data)\n      console.log('This is listMoved event: ',event)\n      // console.log('This is this.lists: ', this.lists)\n      data.append(\"list[position]\", event.newIndex + 1)\n      // console.log('This is data after: ',data)\n      Rails.ajax({\n        url: `/lists/${this.lists[event.newIndex].id}/move`,\n        type: \"PATCH\",\n        data: data,\n        dataType: \"json\",\n      })\n    },\n    submitMessages: function(list_id) {\n      var data = new FormData\n      data.append(\"card[list_id]\", list_id)\n      data.append(\"card[name]\", this.messages[list_id])\n\n      Rails.ajax({\n        url: \"/cards\",\n        type: \"POST\",\n        data: data,\n        dataType: \"json\",\n        success: (data) => {\n          const index = this.lists.findIndex(item => item.id == list_id)\n          // when we drag and drop cards, we need to look up which list has the right id in the lists array\n          this.lists[index].cards.push(data) // will append item to the proper list\n          this.messages[list_id] = undefined\n        }\n      })\n    }\n  }\n}\n</script>\n\n<style scoped>\n.dragArea {\n  min-height: 20px; \n}\n</style>\n// makes drag area visible so that you know that you can drop card there\n\n\n\n// WEBPACK FOOTER //\n// ./app/javascript/app/javascript/app.vue?583dc08d"],"mappings":";AAkGA;AACA;AACA;","sourceRoot":""}